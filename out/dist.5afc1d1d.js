var t=require("net"),e=require("tls"),r=require("events"),o=require("url"),n=require("http"),s=require("https"),i=globalThis.parcelRequire94c2,p=i.register;p("jKGZ8",function(n,s){var p=n.exports&&n.exports.__createBinding||(Object.create?function(t,e,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(e,r);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,o,n)}:function(t,e,r,o){void 0===o&&(o=r),t[o]=e[r]}),u=n.exports&&n.exports.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),c=n.exports&&n.exports.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)"default"!==r&&Object.prototype.hasOwnProperty.call(t,r)&&p(e,t,r);return u(e,t),e},a=n.exports&&n.exports.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(n.exports,"__esModule",{value:!0}),n.exports.HttpProxyAgent=void 0;let l=c(t),f=c(e),d=a(i("kYzEs"));var h=i("eCBrc");let x=(0,d.default)("http-proxy-agent");class y extends h.Agent{constructor(t,e){super(e),this.proxy="string"==typeof t?new o.URL(t):t,this.proxyHeaders=e?.headers??{},x("Creating new HttpProxyAgent instance: %o",this.proxy.href);let r=(this.proxy.hostname||this.proxy.host).replace(/^\[|\]$/g,""),n=this.proxy.port?parseInt(this.proxy.port,10):"https:"===this.proxy.protocol?443:80;this.connectOpts={...e?function(t,...e){let r;let o={};for(r in t)e.includes(r)||(o[r]=t[r]);return o}(e,"headers"):null,host:r,port:n}}addRequest(t,e){t._header=null,this.setRequestProps(t,e),super.addRequest(t,e)}setRequestProps(t,e){let{proxy:r}=this,n=e.secureEndpoint?"https:":"http:",s=t.getHeader("host")||"localhost",i=`${n}//${s}`,p=new o.URL(t.path,i);80!==e.port&&(p.port=String(e.port)),t.path=String(p);let u="function"==typeof this.proxyHeaders?this.proxyHeaders():{...this.proxyHeaders};if(r.username||r.password){let t=`${decodeURIComponent(r.username)}:${decodeURIComponent(r.password)}`;u["Proxy-Authorization"]=`Basic ${Buffer.from(t).toString("base64")}`}for(let e of(u["Proxy-Connection"]||(u["Proxy-Connection"]=this.keepAlive?"Keep-Alive":"close"),Object.keys(u))){let r=u[e];r&&t.setHeader(e,r)}}async connect(t,e){let o,n,s;return t._header=null,t.path.includes("://")||this.setRequestProps(t,e),x("Regenerating stored HTTP header string for request"),t._implicitHeader(),t.outputData&&t.outputData.length>0&&(x("Patching connection write() output buffer with updated header"),n=(o=t.outputData[0].data).indexOf("\r\n\r\n")+4,t.outputData[0].data=t._header+o.substring(n),x("Output buffer: %o",t.outputData[0].data)),"https:"===this.proxy.protocol?(x("Creating `tls.Socket`: %o",this.connectOpts),s=f.connect(this.connectOpts)):(x("Creating `net.Socket`: %o",this.connectOpts),s=l.connect(this.connectOpts)),await (0,r.once)(s,"connect"),s}}y.protocols=["http","https"],n.exports.HttpProxyAgent=y}),p("eCBrc",function(t,e){var r=t.exports&&t.exports.__createBinding||(Object.create?function(t,e,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(e,r);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,o,n)}:function(t,e,r,o){void 0===o&&(o=r),t[o]=e[r]}),o=t.exports&&t.exports.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),s=t.exports&&t.exports.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return o(e,t),e},p=t.exports&&t.exports.__exportStar||function(t,e){for(var o in t)"default"===o||Object.prototype.hasOwnProperty.call(e,o)||r(e,t,o)};Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.Agent=void 0;let u=s(n);p(i("1z9Tp"),t.exports);let c=Symbol("AgentBaseInternalState");class a extends u.Agent{constructor(t){super(t),this[c]={}}isSecureEndpoint(t){if(t){if("boolean"==typeof t.secureEndpoint)return t.secureEndpoint;if("string"==typeof t.protocol)return"https:"===t.protocol}let{stack:e}=Error();return"string"==typeof e&&e.split("\n").some(t=>-1!==t.indexOf("(https.js:")||-1!==t.indexOf("node:https:"))}createSocket(t,e,r){let o={...e,secureEndpoint:this.isSecureEndpoint(e)};Promise.resolve().then(()=>this.connect(t,o)).then(n=>{if(n instanceof u.Agent)return n.addRequest(t,o);this[c].currentSocket=n,super.createSocket(t,e,r)},r)}createConnection(){let t=this[c].currentSocket;if(this[c].currentSocket=void 0,!t)throw Error("No socket was returned in the `connect()` function");return t}get defaultPort(){return this[c].defaultPort??("https:"===this.protocol?443:80)}set defaultPort(t){this[c]&&(this[c].defaultPort=t)}get protocol(){return this[c].protocol??(this.isSecureEndpoint()?"https:":"http:")}set protocol(t){this[c]&&(this[c].protocol=t)}}t.exports.Agent=a}),p("1z9Tp",function(t,e){var r=t.exports&&t.exports.__createBinding||(Object.create?function(t,e,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(e,r);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,o,n)}:function(t,e,r,o){void 0===o&&(o=r),t[o]=e[r]}),o=t.exports&&t.exports.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=t.exports&&t.exports.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)"default"!==n&&Object.prototype.hasOwnProperty.call(t,n)&&r(e,t,n);return o(e,t),e};Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.req=t.exports.json=t.exports.toBuffer=void 0;let p=i(n),u=i(s);async function c(t){let e=0,r=[];for await(let o of t)e+=o.length,r.push(o);return Buffer.concat(r,e)}async function a(t){let e=(await c(t)).toString("utf8");try{return JSON.parse(e)}catch(t){throw t.message+=` (input: ${e})`,t}}t.exports.toBuffer=c,t.exports.json=a,t.exports.req=function(t,e={}){let r=(("string"==typeof t?t:t.href).startsWith("https:")?u:p).request(t,e),o=new Promise((t,e)=>{r.once("response",t).once("error",e).end()});return r.then=o.then.bind(o),r}});
//# sourceMappingURL=dist.5afc1d1d.js.map
