var t=require("net"),e=require("tls"),r=require("events"),o=require("http"),n=require("https"),s=globalThis.parcelRequire94c2,i=s.register;i("exSNK",function(o,n){var i=o.exports&&o.exports.__createBinding||(Object.create?function(t,e,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(e,r);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,o,n)}:function(t,e,r,o){void 0===o&&(o=r),t[o]=e[r]}),p=o.exports&&o.exports.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),u=o.exports&&o.exports.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)"default"!==r&&Object.prototype.hasOwnProperty.call(t,r)&&i(e,t,r);return p(e,t),e},c=o.exports&&o.exports.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(o.exports,"__esModule",{value:!0}),o.exports.HttpProxyAgent=void 0;let a=u(t),l=u(e),f=c(s("kYzEs"));var d=s("eblZh");let h=(0,f.default)("http-proxy-agent");class x extends d.Agent{constructor(t,e){super(e),this.proxy="string"==typeof t?new URL(t):t,this.proxyHeaders=e?.headers??{},h("Creating new HttpProxyAgent instance: %o",this.proxy.href);let r=(this.proxy.hostname||this.proxy.host).replace(/^\[|\]$/g,""),o=this.proxy.port?parseInt(this.proxy.port,10):"https:"===this.proxy.protocol?443:80;this.connectOpts={...e?function(t,...e){let r;let o={};for(r in t)e.includes(r)||(o[r]=t[r]);return o}(e,"headers"):null,host:r,port:o}}addRequest(t,e){t._header=null,this.setRequestProps(t,e),super.addRequest(t,e)}setRequestProps(t,e){let{proxy:r}=this,o=e.secureEndpoint?"https:":"http:",n=t.getHeader("host")||"localhost",s=`${o}//${n}`,i=new URL(t.path,s);80!==e.port&&(i.port=String(e.port)),t.path=String(i);let p="function"==typeof this.proxyHeaders?this.proxyHeaders():{...this.proxyHeaders};if(r.username||r.password){let t=`${decodeURIComponent(r.username)}:${decodeURIComponent(r.password)}`;p["Proxy-Authorization"]=`Basic ${Buffer.from(t).toString("base64")}`}for(let e of(p["Proxy-Connection"]||(p["Proxy-Connection"]=this.keepAlive?"Keep-Alive":"close"),Object.keys(p))){let r=p[e];r&&t.setHeader(e,r)}}async connect(t,e){let o,n,s;return t._header=null,t.path.includes("://")||this.setRequestProps(t,e),h("Regenerating stored HTTP header string for request"),t._implicitHeader(),t.outputData&&t.outputData.length>0&&(h("Patching connection write() output buffer with updated header"),n=(o=t.outputData[0].data).indexOf("\r\n\r\n")+4,t.outputData[0].data=t._header+o.substring(n),h("Output buffer: %o",t.outputData[0].data)),"https:"===this.proxy.protocol?(h("Creating `tls.Socket`: %o",this.connectOpts),s=l.connect(this.connectOpts)):(h("Creating `net.Socket`: %o",this.connectOpts),s=a.connect(this.connectOpts)),await (0,r.once)(s,"connect"),s}}x.protocols=["http","https"],o.exports.HttpProxyAgent=x}),i("eblZh",function(t,e){var r=t.exports&&t.exports.__createBinding||(Object.create?function(t,e,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(e,r);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,o,n)}:function(t,e,r,o){void 0===o&&(o=r),t[o]=e[r]}),n=t.exports&&t.exports.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=t.exports&&t.exports.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var o in t)"default"!==o&&Object.prototype.hasOwnProperty.call(t,o)&&r(e,t,o);return n(e,t),e},p=t.exports&&t.exports.__exportStar||function(t,e){for(var o in t)"default"===o||Object.prototype.hasOwnProperty.call(e,o)||r(e,t,o)};Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.Agent=void 0;let u=i(o);p(s("korUn"),t.exports);let c=Symbol("AgentBaseInternalState");class a extends u.Agent{constructor(t){super(t),this[c]={}}isSecureEndpoint(t){if(t){if("boolean"==typeof t.secureEndpoint)return t.secureEndpoint;if("string"==typeof t.protocol)return"https:"===t.protocol}let{stack:e}=Error();return"string"==typeof e&&e.split("\n").some(t=>-1!==t.indexOf("(https.js:")||-1!==t.indexOf("node:https:"))}createSocket(t,e,r){let o={...e,secureEndpoint:this.isSecureEndpoint(e)};Promise.resolve().then(()=>this.connect(t,o)).then(n=>{if(n instanceof u.Agent)return n.addRequest(t,o);this[c].currentSocket=n,super.createSocket(t,e,r)},r)}createConnection(){let t=this[c].currentSocket;if(this[c].currentSocket=void 0,!t)throw Error("No socket was returned in the `connect()` function");return t}get defaultPort(){return this[c].defaultPort??("https:"===this.protocol?443:80)}set defaultPort(t){this[c]&&(this[c].defaultPort=t)}get protocol(){return this[c].protocol??(this.isSecureEndpoint()?"https:":"http:")}set protocol(t){this[c]&&(this[c].protocol=t)}}t.exports.Agent=a}),i("korUn",function(t,e){var r=t.exports&&t.exports.__createBinding||(Object.create?function(t,e,r,o){void 0===o&&(o=r);var n=Object.getOwnPropertyDescriptor(e,r);(!n||("get"in n?!e.__esModule:n.writable||n.configurable))&&(n={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,o,n)}:function(t,e,r,o){void 0===o&&(o=r),t[o]=e[r]}),s=t.exports&&t.exports.__setModuleDefault||(Object.create?function(t,e){Object.defineProperty(t,"default",{enumerable:!0,value:e})}:function(t,e){t.default=e}),i=t.exports&&t.exports.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var o in t)"default"!==o&&Object.prototype.hasOwnProperty.call(t,o)&&r(e,t,o);return s(e,t),e};Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.req=t.exports.json=t.exports.toBuffer=void 0;let p=i(o),u=i(n);async function c(t){let e=0,r=[];for await(let o of t)e+=o.length,r.push(o);return Buffer.concat(r,e)}async function a(t){let e=(await c(t)).toString("utf8");try{return JSON.parse(e)}catch(t){throw t.message+=` (input: ${e})`,t}}t.exports.toBuffer=c,t.exports.json=a,t.exports.req=function(t,e={}){let r=(("string"==typeof t?t:t.href).startsWith("https:")?u:p).request(t,e),o=new Promise((t,e)=>{r.once("response",t).once("error",e).end()});return r.then=o.then.bind(o),r}});
//# sourceMappingURL=dist.c70534b7.js.map
