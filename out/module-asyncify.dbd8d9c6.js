require("./module.7cbe2af9.js");var e=globalThis.parcelRequire94c2,t=e.register;t("9Pl9k",function(t,i){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.QuickJSAsyncWASMModule=void 0;var s=e("1ODqT"),n=e("bi2gA"),o=e("6TlVH"),r=e("jbyKD");class a extends o.QuickJSWASMModule{constructor(e,t){super(e,t),this.ffi=t,this.module=e}newRuntime(e={}){let t=new n.Lifetime(this.ffi.QTS_NewRuntime(),void 0,e=>{this.callbacks.deleteRuntime(e),this.ffi.QTS_FreeRuntime(e)}),i=new r.QuickJSAsyncRuntime({module:this.module,ffi:this.ffi,rt:t,callbacks:this.callbacks});return(0,o.applyBaseRuntimeOptions)(i,e),e.moduleLoader&&i.setModuleLoader(e.moduleLoader),i}newContext(e={}){let t=this.newRuntime(),i=e.ownedLifetimes?e.ownedLifetimes.concat([t]):[t],s=t.newContext({...e,ownedLifetimes:i});return t.context=s,s}evalCode(){throw new s.QuickJSNotImplemented("QuickJSWASMModuleAsyncify.evalCode: use evalCodeAsync instead")}evalCodeAsync(e,t){return n.Scope.withScopeAsync(async i=>{let s=i.manage(this.newContext());(0,o.applyModuleEvalRuntimeOptions)(s.runtime,t);let n=await s.evalCodeAsync(e,"eval.js");if(void 0!==t.memoryLimitBytes&&s.runtime.setMemoryLimit(-1),n.error)throw s.dump(i.manage(n.error));return s.dump(i.manage(n.value))})}}t.exports.QuickJSAsyncWASMModule=a}),t("jbyKD",function(t,i){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.QuickJSAsyncRuntime=void 0;var s=e("74WSo"),n=e("eGdjB"),o=e("dHRyi"),r=e("b4QHs");class a extends o.QuickJSRuntime{constructor(e){super(e)}newContext(e={}){if(e.intrinsics&&e.intrinsics!==r.DefaultIntrinsics)throw Error("TODO: Custom intrinsics are not supported yet");let t=new s.Lifetime(this.ffi.QTS_NewContext(this.rt.value),void 0,e=>{this.contextMap.delete(e),this.callbacks.deleteContext(e),this.ffi.QTS_FreeContext(e)}),i=new n.QuickJSAsyncContext({module:this.module,ctx:t,ffi:this.ffi,rt:this.rt,ownedLifetimes:[],runtime:this,callbacks:this.callbacks});return this.contextMap.set(t.value,i),i}setModuleLoader(e,t){super.setModuleLoader(e,t)}setMaxStackSize(e){return super.setMaxStackSize(e)}}t.exports.QuickJSAsyncRuntime=a}),t("eGdjB",function(t,i){Object.defineProperty(t.exports,"__esModule",{value:!0}),t.exports.QuickJSAsyncContext=void 0;var s=e("6vZNq"),n=e("6g0BN"),o=e("b4QHs");class r extends s.QuickJSContext{async evalCodeAsync(e,t="eval.js",i){let s=+(void 0===i),r=(0,o.evalOptionsToFlags)(i),a=0;try{a=await this.memory.newHeapCharPointer(e).consume(e=>this.ffi.QTS_Eval_MaybeAsync(this.ctx.value,e.value,t,s,r))}catch(e){throw(0,n.debugLog)("QTS_Eval_MaybeAsync threw",e),e}let u=this.ffi.QTS_ResolveException(this.ctx.value,a);return u?(this.ffi.QTS_FreeValuePointer(this.ctx.value,a),{error:this.memory.heapValueHandle(u)}):{value:this.memory.heapValueHandle(a)}}newAsyncifiedFunction(e,t){return this.newFunction(e,t)}}t.exports.QuickJSAsyncContext=r});
//# sourceMappingURL=module-asyncify.dbd8d9c6.js.map
